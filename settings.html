<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Settings - Accessible Chennai</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="js/app.js"></script>
    <style>
      .fade-in {
        animation: fadeIn 0.5s ease-in-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .toggle {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 24px;
      }
      .toggle input {
        opacity: 0;
        width: 0;
        height: 0;
      }
      .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: .2s;
        border-radius: 24px;
      }
      .slider:before {
        position: absolute;
        content: "";
        height: 16px;
        width: 16px;
        left: 4px;
        bottom: 4px;
        background-color: white;
        transition: .2s;
        border-radius: 50%;
      }
      input:checked + .slider {
        background-color: #3b82f6;
      }
      input:checked + .slider:before {
        transform: translateX(26px);
      }
      input:focus + .slider {
        box-shadow: 0 0 1px #3b82f6;
      }
      .contrast {
        --tw-bg-opacity: 1;
        background-color: rgb(0 0 0 / var(--tw-bg-opacity)) !important;
        color: rgb(255 255 255 / var(--tw-text-opacity)) !important;
      }
      .contrast .toggle-bg {
        background-color: #000 !important;
      }
      .contrast .toggle-slider {
        background-color: #fff !important;
      }
      .btn-scale {
        transition: transform 0.1s ease;
      }
      .btn-scale:active {
        transform: scale(0.95);
      }
      .reduce-motion * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      /* Toast Notification Styles */
      #toast {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background-color: #4CAF50;
        color: white;
        padding: 16px;
        border-radius: 8px;
        z-index: 1000;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      #toast.show {
        opacity: 1;
        transform: translateY(0);
      }
    </style>
  </head>
  <body class="bg-gray-50 text-gray-800 dark:bg-gray-900 dark:text-white transition-all duration-300">
      <h1 class="text-2xl sm:text-3xl font-bold mb-6 flex items-center gap-2">
        <i class="fas fa-cog animate-spin" style="animation-duration: 3s"></i>
        Settings
      </h1>

      <!-- Voice & Audio -->
      <div class="mb-8 bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-lg shadow-sm">
        <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
          <i class="fas fa-volume-up"></i>
          Voice & Audio
        </h2>
        <div class="space-y-3">
          <label class="flex items-center justify-between gap-4 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
            <div class="flex items-center gap-3">
              <i class="fas fa-comment-alt text-blue-500"></i>
              <span>Text-to-Speech (Voice Guidance)</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="ttsToggle" />
              <span class="slider"></span>
            </label>
          </label>

          <label class="flex items-center justify-between gap-4 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
            <div class="flex items-center gap-3">
              <i class="fas fa-bell text-blue-500"></i>
              <span>Audio Notifications</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="audioNotifToggle" checked />
              <span class="slider"></span>
            </label>
          </label>

          <div class="pt-2 mt-2 border-t border-gray-200 dark:border-gray-700">
            <label class="block mb-2">Voice Volume</label>
            <input type="range" id="voiceVolume" min="0" max="100" value="80" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700">
            <div class="flex justify-between text-xs text-gray-500 mt-1">
              <span>Low</span>
              <span>High</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Visual Settings -->
      <div class="mb-8 bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-lg shadow-sm">
        <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
          <i class="fas fa-eye"></i>
          Visual Settings
        </h2>
        <div class="space-y-4">
          <div>
            <label class="block mb-2">Font Size</label>
            <select class="w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-400 transition duration-200" id="fontSizeSelect">
              <option value="small">Small</option>
              <option value="medium" selected>Medium</option>
              <option value="large">Large</option>
              <option value="xlarge">Extra Large</option>
            </select>
          </div>

          <label class="flex items-center justify-between gap-4 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
            <div class="flex items-center gap-3">
              <i class="fas fa-adjust text-blue-500"></i>
              <span>High Contrast Mode</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="contrastToggle" />
              <span class="slider"></span>
            </label>
          </label>

          <label class="flex items-center justify-between gap-4 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
            <div class="flex items-center gap-3">
              <i class="fas fa-moon text-blue-500"></i>
              <span>Dark Mode</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="darkModeToggle" />
              <span class="slider"></span>
            </label>
          </label>

          <label class="flex items-center justify-between gap-4 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
            <div class="flex items-center gap-3">
              <i class="fas fa-running text-blue-500"></i>
              <span>Reduce Motion</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="motionToggle" />
              <span class="slider"></span>
            </label>
          </label>
        </div>
      </div>

      <!-- Screen Reader -->
      <div class="mb-8 bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-lg shadow-sm">
        <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
          <i class="fas fa-assistive-listening-systems"></i>
          Screen Reader
        </h2>
        <div class="space-y-3">
          <label class="flex items-center justify-between gap-4 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
            <div class="flex items-center gap-3">
              <i class="fas fa-universal-access text-blue-500"></i>
              <span>Enable Screen Reader Optimization</span>
            </div>
            <label class="toggle">
              <input type="checkbox" id="screenReaderToggle" checked />
              <span class="slider"></span>
            </label>
          </label>

          <div id="screenReaderOptions" class="pl-12 space-y-3">
            <label class="flex items-center justify-between gap-4 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
              <span>Enhanced Descriptions</span>
              <label class="toggle">
                <input type="checkbox" id="enhancedDescToggle" checked />
                <span class="slider"></span>
              </label>
            </label>

            <label class="flex items-center justify-between gap-4 p-3 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition">
              <span>Navigation Hints</span>
              <label class="toggle">
                <input type="checkbox" id="navHintsToggle" checked />
                <span class="slider"></span>
              </label>
            </label>
          </div>
        </div>
      </div>

      <!-- Language & Region -->
      <div class="mb-8 bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-lg shadow-sm">
        <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
          <i class="fas fa-globe"></i>
          Language & Region
        </h2>
        <div class="space-y-4">
          <div>
            <label class="block mb-2">Preferred Language</label>
            <select class="w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-400 transition duration-200" id="languageSelect">
              <option selected>English (India)</option>
              <option>Tamil</option>
              <option>Hindi</option>
              <option>Telugu</option>
              <option>Malayalam</option>
              <option>Kannada</option>
            </select>
          </div>

          <div>
            <label class="block mb-2">Time Format</label>
            <div class="flex gap-4">
              <label class="flex items-center gap-2">
                <input type="radio" name="timeFormat" class="radio" checked />
                <span>12-hour</span>
              </label>
              <label class="flex items-center gap-2">
                <input type="radio" name="timeFormat" class="radio" />
                <span>24-hour</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="mb-8 bg-white dark:bg-gray-800 p-4 sm:p-6 rounded-lg shadow-sm">
        <h2 class="text-xl font-semibold mb-4 flex items-center gap-2">
          <i class="fas fa-bolt"></i>
          Quick Actions
        </h2>
        <div class="flex flex-wrap gap-3">
          <button class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-200 flex items-center gap-2 btn-scale" onclick="resetSettings()">
            <i class="fas fa-undo"></i> Reset Settings
          </button>
          <button class="bg-gray-200 dark:bg-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition duration-200 flex items-center gap-2 btn-scale" onclick="restoreDefaults()">
            <i class="fas fa-history"></i> Restore Defaults
          </button>
          <button class="w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition btn-scale font-medium flex items-center justify-center gap-2" onclick="saveSettings()">
            <i class="fas fa-save"></i> Save Changes
          </button>
        </div>
      </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast">
      <i class="fas fa-check-circle"></i>
      <span id="toastMessage">Settings saved successfully!</span>
    </div>

    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <script>
      // Load saved settings from localStorage
      function loadSettings() {
        // Dark Mode
        const darkMode = localStorage.getItem('darkMode') === 'true';
        if (darkMode) {
          document.body.classList.add('dark');
          document.getElementById('darkModeToggle').checked = true;
        }

        // Font Size
        const fontSize = localStorage.getItem('fontSize') || 'medium';
        document.getElementById('fontSizeSelect').value = fontSize;
        updateFontSize(fontSize);

        // Other settings
        document.getElementById('ttsToggle').checked = localStorage.getItem('ttsEnabled') !== 'false';
        document.getElementById('audioNotifToggle').checked = localStorage.getItem('audioNotifEnabled') !== 'false';
        document.getElementById('contrastToggle').checked = localStorage.getItem('highContrast') === 'true';
        document.getElementById('motionToggle').checked = localStorage.getItem('reduceMotion') === 'true';
        document.getElementById('screenReaderToggle').checked = localStorage.getItem('screenReaderEnabled') !== 'false';
        document.getElementById('enhancedDescToggle').checked = localStorage.getItem('enhancedDescEnabled') !== 'false';
        document.getElementById('navHintsToggle').checked = localStorage.getItem('navHintsEnabled') !== 'false';
        document.getElementById('voiceVolume').value = localStorage.getItem('voiceVolume') || 80;
        
        const language = localStorage.getItem('language') || 'English (India)';
        document.getElementById('languageSelect').value = language;
        
        const timeFormat = localStorage.getItem('timeFormat') || '12-hour';
        document.querySelector(`input[name="timeFormat"][value="${timeFormat}"]`).checked = true;
      }

      // Update font size
      function updateFontSize(size) {
        const sizes = {
          small: '14px',
          medium: '16px',
          large: '18px',
          xlarge: '20px',
        };
        document.body.style.fontSize = sizes[size];
      }

      // Toggle Dark Mode
      document.getElementById('darkModeToggle')?.addEventListener('change', function() {
        document.body.classList.toggle('dark');
        localStorage.setItem('darkMode', this.checked);
      });

      // Font Size Change
      document.getElementById('fontSizeSelect')?.addEventListener('change', function(e) {
        const size = e.target.value;
        updateFontSize(size);
        localStorage.setItem('fontSize', size);
      });

      // High Contrast Mode
      document.getElementById('contrastToggle')?.addEventListener('change', function(e) {
        document.body.classList.toggle('contrast', e.target.checked);
        localStorage.setItem('highContrast', e.target.checked);
      });

      // Reduced Motion
      document.getElementById('motionToggle')?.addEventListener('change', function(e) {
        document.body.classList.toggle('reduce-motion', e.target.checked);
        localStorage.setItem('reduceMotion', e.target.checked);
      });

      // Screen Reader Toggle
      document.getElementById('screenReaderToggle')?.addEventListener('change', function(e) {
        const optionsDiv = document.getElementById('screenReaderOptions');
        if (e.target.checked) {
          optionsDiv.style.display = 'block';
        } else {
          optionsDiv.style.display = 'none';
        }
        localStorage.setItem('screenReaderEnabled', e.target.checked);
      });

      // Voice Volume
      document.getElementById('voiceVolume')?.addEventListener('input', function(e) {
        localStorage.setItem('voiceVolume', e.target.value);
      });

      // Language Select
      document.getElementById('languageSelect')?.addEventListener('change', function(e) {
        localStorage.setItem('language', e.target.value);
      });

      // Time Format
      document.querySelectorAll('input[name="timeFormat"]').forEach(radio => {
        radio.addEventListener('change', function() {
          localStorage.setItem('timeFormat', this.value);
        });
      });

      // Screen Reader Options
      document.getElementById('enhancedDescToggle')?.addEventListener('change', function(e) {
        localStorage.setItem('enhancedDescEnabled', e.target.checked);
      });

      document.getElementById('navHintsToggle')?.addEventListener('change', function(e) {
        localStorage.setItem('navHintsEnabled', e.target.checked);
      });

      // TTS Toggle
      document.getElementById('ttsToggle')?.addEventListener('change', function(e) {
        localStorage.setItem('ttsEnabled', e.target.checked);
      });

      // Audio Notifications Toggle
      document.getElementById('audioNotifToggle')?.addEventListener('change', function(e) {
        localStorage.setItem('audioNotifEnabled', e.target.checked);
      });

      // Reset Settings
      function resetSettings() {
        if (confirm('Are you sure you want to reset all settings to their previous values?')) {
          localStorage.clear();
          loadSettings();
          showToast('Settings reset successfully');
        }
      }

      // Restore Defaults
      function restoreDefaults() {
        if (confirm('Are you sure you want to restore all settings to their default values?')) {
          const defaults = {
            darkMode: false,
            fontSize: 'medium',
            ttsEnabled: true,
            audioNotifEnabled: true,
            highContrast: false,
            reduceMotion: false,
            screenReaderEnabled: true,
            enhancedDescEnabled: true,
            navHintsEnabled: true,
            voiceVolume: 80,
            language: 'English (India)',
            timeFormat: '12-hour'
          };

          for (const [key, value] of Object.entries(defaults)) {
            localStorage.setItem(key, value);
          }

          loadSettings();
          showToast('Default settings restored');
        }
      }

      // Save settings to localStorage and apply immediately
      function saveSettings() {
        const settings = {
          darkMode: document.getElementById('darkModeToggle').checked,
          fontSize: document.getElementById('fontSizeSelect').value,
          highContrast: document.getElementById('contrastToggle').checked,
          reduceMotion: document.getElementById('motionToggle').checked,
          ttsEnabled: document.getElementById('ttsToggle').checked,
          audioNotifEnabled: document.getElementById('audioNotifToggle').checked,
          screenReaderEnabled: document.getElementById('screenReaderToggle').checked,
          language: document.getElementById('languageSelect').value
        };
        localStorage.setItem('appSettings', JSON.stringify(settings));
        
        // Show toast notification
        showToast('Settings saved successfully');
        
        // Reload the page after a short delay to see the toast
        setTimeout(() => {
          window.location.reload();
        }, 1500); // 1.5 seconds
      }

      // Show toast notification
      function showToast(message) {
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toastMessage');
        toastMessage.textContent = message;
        toast.classList.add('show');
        setTimeout(() => {
          toast.classList.remove('show');
        }, 1500);
      }

      // Apply settings immediately to the UI
      function applySettings(settings) {
        // Dark Mode
        if (settings.darkMode) {
          document.body.classList.add('dark');
        } else {
          document.body.classList.remove('dark');
        }
        // Font Size
        document.body.style.fontSize = {
          small: '14px',
          medium: '16px',
          large: '18px',
          xlarge: '20px'
        }[settings.fontSize];
        // High Contrast
        document.body.classList.toggle('contrast', settings.highContrast);
        // Reduced Motion
        document.body.classList.toggle('reduce-motion', settings.reduceMotion);
      }

      // Load settings when page loads
      document.addEventListener('DOMContentLoaded', function() {
        const savedSettings = localStorage.getItem('appSettings');
        if (savedSettings) {
          const settings = JSON.parse(savedSettings);
          // Set UI elements to match saved settings
          document.getElementById('darkModeToggle').checked = settings.darkMode;
          document.getElementById('fontSizeSelect').value = settings.fontSize;
          document.getElementById('contrastToggle').checked = settings.highContrast;
          document.getElementById('motionToggle').checked = settings.reduceMotion;
          document.getElementById('ttsToggle').checked = settings.ttsEnabled;
          document.getElementById('audioNotifToggle').checked = settings.audioNotifEnabled;
          document.getElementById('screenReaderToggle').checked = settings.screenReaderEnabled;
          document.getElementById('languageSelect').value = settings.language;
          // Apply settings
          applySettings(settings);
        }
        // ...existing initialization code...
        loadSettings();
        document.getElementById('screenReaderOptions').style.display =
          document.getElementById('screenReaderToggle').checked ? 'block' : 'none';
        document.querySelectorAll('input[type="radio"]').forEach(radio => {
          if (!radio.id) {
            radio.id = `radio-${Math.random().toString(36).substr(2, 9)}`;
          }
          if (radio.nextElementSibling?.tagName === 'SPAN') {
            radio.nextElementSibling.setAttribute('for', radio.id);
          }
        });
      });
    </script>
  </body>
</html>